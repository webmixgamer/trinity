name: "{{name}}"
version: "1.0.0"
description: "Content review workflow with AI analysis and human approval"

triggers:
  - type: manual
    id: manual-start

steps:
  - id: analyze-content
    name: Analyze Content
    type: agent_task
    agent: content-analyzer
    message: |
      Please analyze the following content for:
      - Grammar and spelling issues
      - Tone and style consistency
      - Factual accuracy concerns
      - Policy compliance

      Content: {{input.content}}
    output_key: analysis

  - id: check-quality
    name: Check Quality Score
    type: condition
    depends_on:
      - analyze-content
    condition: "{{steps.analyze-content.output.quality_score}} >= 80"
    on_true: auto-approve
    on_false: manual-review

  - id: manual-review
    name: Manual Review Required
    type: user_task
    depends_on:
      - check-quality
    prompt: |
      The content did not meet auto-approval threshold.

      Analysis Results:
      {{steps.analyze-content.output.analysis}}

      Quality Score: {{steps.analyze-content.output.quality_score}}

      Please review and decide whether to approve or reject.
    options:
      - approve
      - reject
      - request-changes
    assignee: content-reviewer

  - id: auto-approve
    name: Auto Approve
    type: agent_task
    depends_on:
      - check-quality
    agent: content-publisher
    message: |
      Content has passed quality checks. Please prepare for publication.

      Content: {{input.content}}
      Analysis: {{steps.analyze-content.output}}
    output_key: publication_ready

outputs:
  - name: approval_status
    value: "{{steps.manual-review.output.decision || 'auto-approved'}}"
  - name: analysis_summary
    value: "{{steps.analyze-content.output.analysis}}"

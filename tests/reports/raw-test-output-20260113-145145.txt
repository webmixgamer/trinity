============================= test session starts ==============================
platform darwin -- Python 3.14.0, pytest-9.0.2, pluggy-1.6.0 -- /Users/eugene/Dropbox/trinity/trinity/tests/.venv/bin/python
cachedir: .pytest_cache
metadata: {'Python': '3.14.0', 'Platform': 'macOS-15.6.1-arm64-arm-64bit-Mach-O', 'Packages': {'pytest': '9.0.2', 'pluggy': '1.6.0'}, 'Plugins': {'anyio': '4.12.0', 'html': '4.1.1', 'timeout': '2.4.0', 'metadata': '3.1.1', 'asyncio': '1.3.0', 'cov': '7.0.0'}}
rootdir: /Users/eugene/Dropbox/trinity/trinity/tests
configfile: pytest.ini
testpaths: .
plugins: anyio-4.12.0, html-4.1.1, timeout-2.4.0, metadata-3.1.1, asyncio-1.3.0, cov-7.0.0
timeout: 120.0s
timeout method: signal
timeout func_only: False
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 626 items / 69 deselected / 557 selected

agent_server/test_agent_chat_direct.py::TestChatHistory::test_get_history <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_chat_direct.py SKIPPED [  0%]
agent_server/test_agent_chat_direct.py::TestSessionInfo::test_get_session_stats <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_chat_direct.py SKIPPED [  0%]
agent_server/test_agent_chat_direct.py::TestClearHistory::test_clear_conversation <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_chat_direct.py SKIPPED [  0%]
agent_server/test_agent_chat_direct.py::TestModelManagement::test_get_model <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_chat_direct.py SKIPPED [  0%]
agent_server/test_agent_chat_direct.py::TestModelManagement::test_set_model <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_chat_direct.py SKIPPED [  0%]
agent_server/test_agent_files_direct.py::TestListFiles::test_list_files_tree <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_files_direct.py SKIPPED [  1%]
agent_server/test_agent_files_direct.py::TestListFiles::test_excludes_hidden_files <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_files_direct.py SKIPPED [  1%]
agent_server/test_agent_files_direct.py::TestDownloadFile::test_download_file <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_files_direct.py SKIPPED [  1%]
agent_server/test_agent_files_direct.py::TestDownloadFile::test_path_traversal_blocked <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_files_direct.py SKIPPED [  1%]
agent_server/test_agent_info.py::TestRootEndpoint::test_root_returns_service_info <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_info.py SKIPPED [  1%]
agent_server/test_agent_info.py::TestHealthCheck::test_health_returns_healthy <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_info.py SKIPPED [  1%]
agent_server/test_agent_info.py::TestAgentInfo::test_agent_info_returns_details <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_info.py SKIPPED [  2%]
agent_server/test_agent_info.py::TestTemplateInfo::test_template_info <- ../../../Coding/N8N_Main_repos/project_trinity/tests/agent_server/test_agent_info.py SKIPPED [  2%]
test_activities.py::TestActivityTimelineAuthentication::test_timeline_requires_auth PASSED [  2%]
test_activities.py::TestActivityTimelineAuthentication::test_agent_activities_requires_auth PASSED [  2%]
test_activities.py::TestActivityTimeline::test_timeline_returns_structure PASSED [  2%]
test_activities.py::TestActivityTimeline::test_timeline_activities_structure PASSED [  3%]
test_activities.py::TestActivityTimeline::test_timeline_respects_limit PASSED [  3%]
test_activities.py::TestActivityTimeline::test_timeline_filter_by_type PASSED [  3%]
test_activities.py::TestActivityTimeline::test_timeline_filter_multiple_types PASSED [  3%]
test_activities.py::TestActivityTimeline::test_timeline_filter_by_time_range PASSED [  3%]
test_activities.py::TestActivityTimeline::test_timeline_empty_result_structure PASSED [  3%]
test_activities.py::TestAgentActivities::test_agent_activities_returns_structure PASSED [  4%]
test_activities.py::TestAgentActivities::test_agent_activities_filter_by_type PASSED [  4%]
test_activities.py::TestAgentActivities::test_agent_activities_filter_by_state PASSED [  4%]
test_activities.py::TestAgentActivities::test_agent_activities_respects_limit PASSED [  4%]
test_activities.py::TestAgentActivities::test_nonexistent_agent_returns_404 PASSED [  4%]
test_activities.py::TestCrossAgentTimeline::test_timeline_includes_multiple_agents PASSED [  5%]
test_activities.py::TestCrossAgentTimeline::test_timeline_sorted_by_time PASSED [  5%]
test_activities.py::TestTimelineForDashboard::test_timeline_activity_types_for_dashboard PASSED [  5%]
test_activities.py::TestTimelineForDashboard::test_timeline_activity_has_duration PASSED [  5%]
test_activities.py::TestTimelineForDashboard::test_timeline_activity_has_triggered_by PASSED [  5%]
test_activities.py::TestTimelineForDashboard::test_timeline_activity_details_structure PASSED [  5%]
test_activities.py::TestTimelineForDashboard::test_timeline_collaboration_filter PASSED [  6%]
test_activities.py::TestTimelineForDashboard::test_timeline_schedule_filter PASSED [  6%]
test_activities.py::TestTimelineForDashboard::test_timeline_trigger_type_values PASSED [  6%]
test_agent_api_key_setting.py::TestApiKeySettingAuthentication::test_get_api_key_setting_requires_auth PASSED [  6%]
test_agent_api_key_setting.py::TestApiKeySettingAuthentication::test_put_api_key_setting_requires_auth PASSED [  6%]
test_agent_api_key_setting.py::TestApiKeySettingCRUD::test_get_api_key_setting_returns_structure FAILED [  7%]
test_agent_api_key_setting.py::TestApiKeySettingCRUD::test_get_api_key_setting_default_is_true FAILED [  7%]
test_agent_api_key_setting.py::TestApiKeySettingCRUD::test_get_api_key_setting_nonexistent_agent_returns_404 PASSED [  7%]
test_agent_api_key_setting.py::TestApiKeySettingCRUD::test_put_api_key_setting_update_and_restore FAILED [  7%]
test_agent_api_key_setting.py::TestApiKeySettingCRUD::test_put_api_key_setting_nonexistent_agent_returns_404 PASSED [  7%]
test_agent_api_key_setting.py::TestApiKeySettingCRUD::test_put_api_key_setting_missing_field_returns_error FAILED [  7%]
test_agent_api_key_setting.py::TestApiKeySettingValidation::test_put_api_key_setting_string_value_handled FAILED [  8%]
test_agent_api_key_setting.py::TestApiKeySettingValidation::test_put_api_key_setting_invalid_json PASSED [  8%]
test_agent_api_key_setting.py::TestApiKeySettingPermissions::test_admin_can_read_api_key_setting FAILED [  8%]
test_agent_api_key_setting.py::TestApiKeySettingPermissions::test_admin_can_update_api_key_setting FAILED [  8%]
test_agent_api_key_setting.py::TestApiKeySettingAgentState::test_api_key_setting_readable_for_running_agent SKIPPED [  8%]
test_agent_api_key_setting.py::TestApiKeySettingAgentState::test_api_key_setting_update_response_structure FAILED [  8%]
test_agent_api_key_setting.py::TestApiKeySettingIntegration::test_api_key_setting_get_put_consistency FAILED [  9%]
test_agent_api_key_setting.py::TestApiKeySettingResponseFormat::test_get_response_has_agent_name FAILED [  9%]
test_agent_api_key_setting.py::TestApiKeySettingResponseFormat::test_put_response_has_updated_value FAILED [  9%]
test_agent_chat.py::TestSendChatMessage::test_chat_nonexistent_agent_returns_404 PASSED [  9%]
test_agent_chat.py::TestSendChatMessage::test_chat_stopped_agent_returns_error PASSED [  9%]
test_agent_chat.py::TestChatHistory::test_get_chat_history PASSED        [ 10%]
test_agent_chat.py::TestChatHistory::test_get_persistent_chat_history PASSED [ 10%]
test_agent_chat.py::TestSessionInfo::test_get_session_info PASSED        [ 10%]
test_agent_chat.py::TestChatSessions::test_list_chat_sessions PASSED     [ 10%]
test_agent_chat.py::TestChatSessions::test_list_chat_sessions_structure PASSED [ 10%]
test_agent_chat.py::TestChatSessions::test_list_chat_sessions_nonexistent_agent_returns_404 PASSED [ 10%]
test_agent_chat.py::TestChatSessions::test_get_session_details SKIPPED   [ 11%]
test_agent_chat.py::TestChatSessions::test_get_session_details_nonexistent_returns_404 PASSED [ 11%]
test_agent_chat.py::TestChatSessions::test_close_session SKIPPED (No
sessions available for testing)                                          [ 11%]
test_agent_chat.py::TestChatSessions::test_close_session_nonexistent_returns_404 PASSED [ 11%]
test_agent_chat.py::TestChatSessions::test_close_session_requires_auth PASSED [ 11%]
test_agent_chat.py::TestModelManagement::test_get_current_model PASSED   [ 12%]
test_agent_chat.py::TestModelManagement::test_set_valid_model PASSED     [ 12%]
test_agent_chat.py::TestResetSession::test_reset_session PASSED          [ 12%]
test_agent_chat.py::TestInMemoryActivityAuthentication::test_activity_requires_auth PASSED [ 12%]
test_agent_chat.py::TestInMemoryActivityAuthentication::test_clear_activity_requires_auth PASSED [ 12%]
test_agent_chat.py::TestInMemoryActivity::test_get_activity_returns_structure PASSED [ 12%]
test_agent_chat.py::TestInMemoryActivity::test_get_activity_empty_when_idle PASSED [ 13%]
test_agent_chat.py::TestInMemoryActivity::test_get_activity_nonexistent_agent_returns_404 PASSED [ 13%]
test_agent_chat.py::TestInMemoryActivityToolDetails::test_get_tool_details_nonexistent PASSED [ 13%]
test_agent_chat.py::TestClearInMemoryActivity::test_clear_activity PASSED [ 13%]
test_agent_chat.py::TestClearInMemoryActivity::test_clear_activity_idempotent PASSED [ 13%]
test_agent_chat.py::TestModelManagementExtended::test_set_invalid_model_rejected SKIPPED [ 14%]
test_agent_chat.py::TestModelManagementExtended::test_set_model_persists PASSED [ 14%]
test_agent_chat.py::TestModelManagementExtended::test_model_options PASSED [ 14%]
test_agent_chat.py::TestModelManagementExtended::test_get_model_structure PASSED [ 14%]
test_agent_dashboard.py::TestDashboardEndpointAuthentication::test_dashboard_requires_auth PASSED [ 14%]
test_agent_dashboard.py::TestDashboardEndpoint::test_dashboard_returns_structure PASSED [ 14%]
test_agent_dashboard.py::TestDashboardEndpoint::test_agent_without_dashboard_returns_has_dashboard_false PASSED [ 15%]
test_agent_dashboard.py::TestDashboardEndpoint::test_dashboard_config_structure_when_present PASSED [ 15%]
test_agent_dashboard.py::TestDashboardEndpoint::test_nonexistent_agent_returns_404 PASSED [ 15%]
test_agent_dashboard.py::TestDashboardEndpoint::test_dashboard_status_reflects_agent_state PASSED [ 15%]
test_agent_dashboard.py::TestDashboardWidgetTypes::test_dashboard_supports_metric_widget PASSED [ 15%]
test_agent_dashboard.py::TestDashboardWidgetTypes::test_dashboard_last_modified_timestamp PASSED [ 15%]
test_agent_files.py::TestListFiles::test_list_files_returns_tree PASSED  [ 16%]
test_agent_files.py::TestListFiles::test_file_has_required_fields PASSED [ 16%]
test_agent_files.py::TestListFiles::test_directory_has_children PASSED   [ 16%]
test_agent_files.py::TestListFiles::test_hidden_files_excluded PASSED    [ 16%]
test_agent_files.py::TestDownloadFile::test_download_existing_file SKIPPED [ 16%]
test_agent_files.py::TestDownloadFile::test_download_nonexistent_file_returns_404 PASSED [ 17%]
test_agent_files.py::TestDownloadFile::test_download_directory_returns_400 PASSED [ 17%]
test_agent_files.py::TestDownloadFile::test_path_traversal_blocked PASSED [ 17%]
test_agent_files.py::TestPreviewFile::test_preview_text_file_returns_content SKIPPED [ 17%]
test_agent_files.py::TestPreviewFile::test_preview_nonexistent_file_returns_404 PASSED [ 17%]
test_agent_files.py::TestPreviewFile::test_preview_requires_auth PASSED  [ 17%]
test_agent_files.py::TestUpdateFile::test_update_file_changes_content FAILED [ 18%]
test_agent_files.py::TestUpdateFile::test_update_creates_file_if_not_exists FAILED [ 18%]
test_agent_files.py::TestUpdateFile::test_update_nonexistent_agent_returns_404 PASSED [ 18%]
test_agent_files.py::TestUpdateFile::test_update_requires_auth PASSED    [ 18%]
test_agent_files.py::TestDeleteFile::test_delete_file_removes_it SKIPPED [ 18%]
test_agent_files.py::TestDeleteFile::test_delete_nonexistent_file_returns_404 PASSED [ 19%]
test_agent_files.py::TestDeleteFile::test_delete_nonexistent_agent_returns_404 PASSED [ 19%]
test_agent_files.py::TestDeleteFile::test_delete_requires_auth PASSED    [ 19%]
test_agent_files.py::TestShowHiddenFiles::test_list_with_show_hidden_true PASSED [ 19%]
test_agent_files.py::TestShowHiddenFiles::test_list_with_show_hidden_false_excludes_dotfiles PASSED [ 19%]
test_agent_files.py::TestShowHiddenFiles::test_hidden_parameter_default_behavior PASSED [ 19%]
test_agent_git.py::TestGitStatus::test_get_git_status PASSED             [ 20%]
test_agent_git.py::TestGitStatus::test_git_disabled_returns_false PASSED [ 20%]
test_agent_git.py::TestGitSync::test_git_sync SKIPPED (Git not
configured for agent)                                                    [ 20%]
test_agent_git.py::TestGitSync::test_git_sync_nonexistent_agent PASSED   [ 20%]
test_agent_git.py::TestGitLog::test_get_git_log SKIPPED (Git not
configured for agent)                                                    [ 20%]
test_agent_git.py::TestGitLog::test_git_log_with_limit PASSED            [ 21%]
test_agent_git.py::TestGitPull::test_git_pull SKIPPED (Git not
configured for agent)                                                    [ 21%]
test_agent_git.py::TestGitInitializeAuthentication::test_git_init_requires_auth PASSED [ 21%]
test_agent_git.py::TestGitInitialize::test_git_init_nonexistent_agent_returns_404 PASSED [ 21%]
test_agent_git.py::TestGitInitialize::test_git_init_returns_structure FAILED [ 21%]
test_agent_git.py::TestGitInitialize::test_git_init_requires_repo_owner PASSED [ 21%]
test_agent_git.py::TestGitInitialize::test_git_init_requires_repo_name PASSED [ 22%]
test_agent_git.py::TestGitInitialize::test_git_init_stopped_agent_returns_400 PASSED [ 22%]
test_agent_git.py::TestGitInitialize::test_git_init_create_repo_parameter SKIPPED [ 22%]
test_agent_git.py::TestGitInitializeIdempotency::test_git_init_already_configured_returns_409 PASSED [ 22%]
test_agent_lifecycle.py::TestListAgents::test_list_agents_returns_array PASSED [ 22%]
test_agent_lifecycle.py::TestListAgents::test_list_agents_has_required_fields PASSED [ 22%]
test_agent_lifecycle.py::TestListAgents::test_list_agents_requires_auth PASSED [ 23%]
test_agent_lifecycle.py::TestCreateAgent::test_create_minimal_agent PASSED [ 23%]
test_agent_lifecycle.py::TestCreateAgent::test_create_agent_with_template PASSED [ 23%]
test_agent_lifecycle.py::TestCreateAgent::test_create_agent_with_resources PASSED [ 23%]
test_agent_lifecycle.py::TestCreateAgent::test_duplicate_name_returns_409 PASSED [ 23%]
test_agent_lifecycle.py::TestCreateAgent::test_invalid_name_is_sanitized PASSED [ 24%]
test_agent_lifecycle.py::TestCreateAgent::test_agent_auto_started_after_creation PASSED [ 24%]
test_agent_lifecycle.py::TestGetAgent::test_get_agent_returns_details PASSED [ 24%]
test_agent_lifecycle.py::TestGetAgent::test_get_nonexistent_agent_returns_404 PASSED [ 24%]
test_agent_lifecycle.py::TestGetAgent::test_get_agent_requires_auth PASSED [ 24%]
test_agent_lifecycle.py::TestStartAgent::test_start_stopped_agent PASSED [ 24%]
test_agent_lifecycle.py::TestStartAgent::test_start_running_agent_idempotent PASSED [ 25%]
test_agent_lifecycle.py::TestStartAgent::test_start_nonexistent_agent_returns_404 PASSED [ 25%]
test_agent_lifecycle.py::TestStopAgent::test_stop_running_agent PASSED   [ 25%]
test_agent_lifecycle.py::TestStopAgent::test_stop_stopped_agent_idempotent PASSED [ 25%]
test_agent_lifecycle.py::TestStopAgent::test_stop_nonexistent_agent_returns_404 PASSED [ 25%]
test_agent_lifecycle.py::TestDeleteAgent::test_delete_agent PASSED       [ 26%]
test_agent_lifecycle.py::TestDeleteAgent::test_delete_nonexistent_agent_returns_404 PASSED [ 26%]
test_agent_lifecycle.py::TestAgentLogs::test_get_agent_logs PASSED       [ 26%]
test_agent_lifecycle.py::TestAgentLogs::test_get_logs_with_lines_param PASSED [ 26%]
test_agent_lifecycle.py::TestAgentInfo::test_get_agent_info PASSED       [ 26%]
test_agent_lifecycle.py::TestAgentInfo::test_get_info_nonexistent_agent_returns_404 PASSED [ 26%]
test_agent_metrics.py::TestAgentMetricsAuthentication::test_metrics_requires_auth PASSED [ 27%]
test_agent_metrics.py::TestAgentMetricsEndpoint::test_metrics_returns_structure PASSED [ 27%]
test_agent_metrics.py::TestAgentMetricsEndpoint::test_metrics_status_field PASSED [ 27%]
test_agent_metrics.py::TestAgentMetricsEndpoint::test_metrics_has_metrics_boolean PASSED [ 27%]
test_agent_metrics.py::TestAgentMetricsEndpoint::test_metrics_with_definitions PASSED [ 27%]
test_agent_metrics.py::TestAgentMetricsEndpoint::test_metrics_with_values PASSED [ 28%]
test_agent_metrics.py::TestAgentMetricsEndpoint::test_nonexistent_agent_returns_404 PASSED [ 28%]
test_agent_metrics.py::TestAgentMetricsStopped::test_stopped_agent_metrics PASSED [ 28%]
test_agent_metrics.py::TestMetricTypes::test_metric_type_validation PASSED [ 28%]
test_agent_metrics.py::TestMetricTypes::test_percentage_metric_value_range PASSED [ 28%]
test_agent_metrics.py::TestMetricsLastUpdated::test_has_last_updated_when_metrics_present PASSED [ 28%]
test_agent_metrics.py::TestMetricsAccessControl::test_shared_agent_metrics_accessible PASSED [ 29%]
test_agent_metrics.py::TestMetricsAccessControl::test_unowned_unshared_agent_denied PASSED [ 29%]
test_agent_permissions.py::TestGetPermissions::test_get_permissions_returns_structure <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 29%]
test_agent_permissions.py::TestGetPermissions::test_get_permissions_for_nonexistent_agent <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 29%]
test_agent_permissions.py::TestGetPermissions::test_available_agents_have_required_fields <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 29%]
test_agent_permissions.py::TestSetPermissions::test_set_permissions_empty_list <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 29%]
test_agent_permissions.py::TestSetPermissions::test_set_permissions_with_self_is_handled <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 30%]
test_agent_permissions.py::TestSetPermissions::test_set_permissions_with_nonexistent_agent <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 30%]
test_agent_permissions.py::TestAddPermission::test_add_permission_returns_status <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 30%]
test_agent_permissions.py::TestAddPermission::test_add_permission_idempotent <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 30%]
test_agent_permissions.py::TestAddPermission::test_add_permission_to_nonexistent_target <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 30%]
test_agent_permissions.py::TestAddPermission::test_add_permission_to_self <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 31%]
test_agent_permissions.py::TestRemovePermission::test_remove_permission <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 31%]
test_agent_permissions.py::TestRemovePermission::test_remove_nonexistent_permission <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 31%]
test_agent_permissions.py::TestDefaultPermissions::test_new_agent_has_default_permissions <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 31%]
test_agent_permissions.py::TestPermissionCascadeDelete::test_permissions_removed_on_agent_delete <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 31%]
test_agent_permissions.py::TestPermissionAuthorization::test_get_permissions_requires_access <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 31%]
test_agent_permissions.py::TestPermissionAuthorization::test_set_permissions_requires_access <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_permissions.py PASSED [ 32%]
test_agent_sharing.py::TestShareAgent::test_share_agent_with_email <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_sharing.py PASSED [ 32%]
test_agent_sharing.py::TestShareAgent::test_share_with_role <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_sharing.py PASSED [ 32%]
test_agent_sharing.py::TestShareAgent::test_cannot_share_with_self <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_sharing.py SKIPPED [ 32%]
test_agent_sharing.py::TestListShares::test_list_shares <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_sharing.py PASSED [ 32%]
test_agent_sharing.py::TestListShares::test_share_has_required_fields <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_sharing.py PASSED [ 33%]
test_agent_sharing.py::TestUnshareAgent::test_unshare_agent <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_sharing.py PASSED [ 33%]
test_agent_sharing.py::TestUnshareAgent::test_unshare_nonexistent_share <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_agent_sharing.py PASSED [ 33%]
test_auth.py::TestAuthenticationMode::test_auth_mode_returns_valid_response PASSED [ 33%]
test_auth.py::TestAuthenticationMode::test_auth_mode_returns_email_auth_status PASSED [ 33%]
test_auth.py::TestAuthenticationMode::test_auth_mode_accessible_without_auth PASSED [ 33%]
test_auth.py::TestLogin::test_valid_credentials_returns_token PASSED     [ 34%]
test_auth.py::TestLogin::test_invalid_credentials_returns_401 PASSED     [ 34%]
test_auth.py::TestLogin::test_missing_credentials_returns_422 PASSED     [ 34%]
test_auth.py::TestLogin::test_token_can_be_used_for_auth PASSED          [ 34%]
test_auth.py::TestTokenValidation::test_valid_token_returns_user_info PASSED [ 34%]
test_auth.py::TestTokenValidation::test_missing_token_returns_401 PASSED [ 35%]
test_auth.py::TestTokenValidation::test_invalid_token_returns_401 PASSED [ 35%]
test_auth.py::TestTokenValidation::test_malformed_token_returns_401 PASSED [ 35%]
test_auth.py::TestUserEndpoint::test_get_current_user PASSED             [ 35%]
test_auth.py::TestHealthEndpoint::test_health_check PASSED               [ 35%]
test_credentials.py::TestCreateCredential::test_create_credential PASSED [ 35%]
test_credentials.py::TestCreateCredential::test_create_credential_without_service PASSED [ 36%]
test_credentials.py::TestListCredentials::test_list_credentials PASSED   [ 36%]
test_credentials.py::TestListCredentials::test_credentials_dont_expose_secrets PASSED [ 36%]
test_credentials.py::TestBulkImport::test_bulk_import_env_format PASSED  [ 36%]
test_credentials.py::TestBulkImport::test_bulk_import_auto_detects_service PASSED [ 36%]
test_credentials.py::TestHotReload::test_hot_reload_credentials PASSED   [ 36%]
test_credentials.py::TestHotReload::test_hot_reload_stopped_agent_fails PASSED [ 37%]
test_credentials.py::TestHotReloadRedisPersistence::test_hot_reload_saves_to_redis PASSED [ 37%]
test_credentials.py::TestHotReloadRedisPersistence::test_hot_reload_conflict_resolution_reuse PASSED [ 37%]
test_credentials.py::TestHotReloadRedisPersistence::test_hot_reload_conflict_resolution_rename PASSED [ 37%]
test_credentials.py::TestHotReloadRedisPersistence::test_hot_reload_multiple_credentials PASSED [ 37%]
test_credentials.py::TestHotReloadRedisPersistence::test_hot_reload_with_quotes PASSED [ 38%]
test_credentials.py::TestCredentialStatus::test_get_credential_status PASSED [ 38%]
test_credentials.py::TestAgentCredentialRequirements::test_get_agent_credential_requirements PASSED [ 38%]
test_credentials.py::TestReloadFromStore::test_reload_credentials_from_store PASSED [ 38%]
test_deploy_local.py::TestDeployLocalAuthentication::test_deploy_requires_auth PASSED [ 38%]
test_deploy_local.py::TestDeployLocalValidation::test_missing_archive_rejected PASSED [ 38%]
test_deploy_local.py::TestDeployLocalValidation::test_invalid_base64_rejected PASSED [ 39%]
test_deploy_local.py::TestDeployLocalValidation::test_invalid_archive_format_rejected PASSED [ 39%]
test_deploy_local.py::TestDeployLocalValidation::test_missing_template_yaml_rejected PASSED [ 39%]
test_deploy_local.py::TestDeployLocalTemplateValidation::test_template_missing_name_rejected PASSED [ 39%]
test_deploy_local.py::TestDeployLocalTemplateValidation::test_template_missing_resources_rejected PASSED [ 39%]
test_deploy_local.py::TestDeployLocalLimits::test_too_many_credentials_rejected PASSED [ 40%]
test_deploy_local.py::TestDeployLocalSecurity::test_path_traversal_rejected PASSED [ 40%]
test_email_auth.py::TestAuthModeEmailAuth::test_auth_mode_includes_email_auth_flag PASSED [ 40%]
test_email_auth.py::TestAuthModeEmailAuth::test_auth_mode_email_auth_is_boolean PASSED [ 40%]
test_email_auth.py::TestEmailLoginRequest::test_request_code_requires_setup_completed SKIPPED [ 40%]
test_email_auth.py::TestEmailLoginRequest::test_request_code_missing_email_returns_error PASSED [ 40%]
test_email_auth.py::TestEmailLoginRequest::test_request_code_returns_success_structure PASSED [ 41%]
test_email_auth.py::TestEmailLoginRequest::test_request_code_invalid_email_format_accepted_for_security PASSED [ 41%]
test_email_auth.py::TestEmailLoginVerify::test_verify_code_requires_setup_completed SKIPPED [ 41%]
test_email_auth.py::TestEmailLoginVerify::test_verify_code_missing_fields_returns_error PASSED [ 41%]
test_email_auth.py::TestEmailLoginVerify::test_verify_code_invalid_code_returns_401 PASSED [ 41%]
test_email_auth.py::TestEmailWhitelistAuthentication::test_list_whitelist_requires_auth PASSED [ 42%]
test_email_auth.py::TestEmailWhitelistAuthentication::test_add_whitelist_requires_auth PASSED [ 42%]
test_email_auth.py::TestEmailWhitelistAuthentication::test_delete_whitelist_requires_auth PASSED [ 42%]
test_email_auth.py::TestEmailWhitelistAdmin::test_list_whitelist_returns_structure PASSED [ 42%]
test_email_auth.py::TestEmailWhitelistAdmin::test_add_whitelist_invalid_email_handled PASSED [ 42%]
test_email_auth.py::TestEmailWhitelistAdmin::test_add_whitelist_returns_success PASSED [ 42%]
test_email_auth.py::TestEmailWhitelistAdmin::test_delete_whitelist_nonexistent_returns_404 PASSED [ 43%]
test_email_auth.py::TestEmailWhitelistCRUD::test_whitelist_full_lifecycle PASSED [ 43%]
test_email_auth.py::TestEmailWhitelistCRUD::test_whitelist_duplicate_email_returns_409 PASSED [ 43%]
test_email_auth.py::TestEmailAuthDisabled::test_request_code_when_disabled_returns_403 PASSED [ 43%]
test_execution_queue.py::TestQueueStatus::test_get_queue_status PASSED   [ 43%]
test_execution_queue.py::TestQueueStatus::test_queue_status_has_agent_name PASSED [ 43%]
test_execution_queue.py::TestQueueStatus::test_idle_agent_not_busy PASSED [ 44%]
test_execution_queue.py::TestQueueStatus::test_idle_agent_empty_queue PASSED [ 44%]
test_execution_queue.py::TestQueueStatus::test_queue_status_includes_queued_executions PASSED [ 44%]
test_execution_queue.py::TestQueueStatus::test_queue_status_nonexistent_agent PASSED [ 44%]
test_execution_queue.py::TestQueueStatus::test_queue_status_requires_auth PASSED [ 44%]
test_execution_queue.py::TestClearQueue::test_clear_queue PASSED         [ 45%]
test_execution_queue.py::TestClearQueue::test_clear_queue_returns_cleared_count PASSED [ 45%]
test_execution_queue.py::TestClearQueue::test_clear_queue_nonexistent_agent PASSED [ 45%]
test_execution_queue.py::TestClearQueue::test_clear_queue_requires_auth PASSED [ 45%]
test_execution_queue.py::TestForceRelease::test_force_release PASSED     [ 45%]
test_execution_queue.py::TestForceRelease::test_force_release_returns_was_running PASSED [ 45%]
test_execution_queue.py::TestForceRelease::test_force_release_includes_warning PASSED [ 46%]
test_execution_queue.py::TestForceRelease::test_force_release_nonexistent_agent PASSED [ 46%]
test_execution_queue.py::TestForceRelease::test_force_release_requires_auth PASSED [ 46%]
test_execution_queue.py::TestQueueAfterOperations::test_queue_idle_after_clear PASSED [ 46%]
test_execution_queue.py::TestQueueAfterOperations::test_queue_idle_after_release PASSED [ 46%]
test_execution_streaming.py::TestExecutionStreamingAuthentication::test_stream_requires_authentication PASSED [ 47%]
test_execution_streaming.py::TestExecutionStreamingEndpoint::test_stream_nonexistent_agent_returns_404 PASSED [ 47%]
test_execution_streaming.py::TestExecutionStreamingEndpoint::test_stream_nonexistent_execution_returns_404 FAILED [ 47%]
test_execution_streaming.py::TestExecutionStreamingEndpoint::test_stream_endpoint_exists FAILED [ 47%]
test_execution_streaming.py::TestExecutionStreamingErrors::test_stream_invalid_execution_id_format FAILED [ 47%]
test_execution_streaming.py::TestExecutionStreamingErrors::test_stream_empty_execution_id PASSED [ 47%]
test_execution_termination.py::TestRunningExecutions::test_get_running_executions_returns_list PASSED [ 48%]
test_execution_termination.py::TestRunningExecutions::test_running_executions_empty_when_idle PASSED [ 48%]
test_execution_termination.py::TestRunningExecutions::test_running_executions_nonexistent_agent_returns_404 PASSED [ 48%]
test_execution_termination.py::TestRunningExecutions::test_running_executions_stopped_agent_returns_empty PASSED [ 48%]
test_execution_termination.py::TestRunningExecutions::test_running_executions_requires_auth PASSED [ 48%]
test_execution_termination.py::TestTerminateExecution::test_terminate_nonexistent_execution_returns_404 PASSED [ 49%]
test_execution_termination.py::TestTerminateExecution::test_terminate_nonexistent_agent_returns_404 PASSED [ 49%]
test_execution_termination.py::TestTerminateExecution::test_terminate_stopped_agent_returns_503 PASSED [ 49%]
test_execution_termination.py::TestTerminateExecution::test_terminate_requires_auth PASSED [ 49%]
test_executions.py::TestExecutionsEndpoint::test_get_executions_returns_list PASSED [ 49%]
test_executions.py::TestExecutionsEndpoint::test_get_executions_with_limit PASSED [ 49%]
test_executions.py::TestExecutionsEndpoint::test_get_executions_nonexistent_agent_returns_404 PASSED [ 50%]
test_executions.py::TestExecutionsEndpoint::test_get_executions_requires_auth PASSED [ 50%]
test_executions.py::TestExecutionFiltering::test_executions_filter_by_status PASSED [ 50%]
test_executions.py::TestExecutionFiltering::test_executions_filter_by_triggered_by PASSED [ 50%]
test_executions.py::TestExecutionLog::test_get_execution_log_nonexistent_returns_404 PASSED [ 50%]
test_executions.py::TestExecutionLog::test_get_execution_log_nonexistent_agent_returns_404 PASSED [ 50%]
test_executions.py::TestExecutionLog::test_get_execution_log_requires_auth PASSED [ 51%]
test_executions.py::TestExecutionDetails::test_get_execution_details SKIPPED [ 51%]
test_executions.py::TestExecutionDetails::test_get_execution_details_nonexistent_returns_404 PASSED [ 51%]
test_executions.py::TestExecutionDetails::test_get_execution_details_requires_auth PASSED [ 51%]
test_log_archive.py::TestLogArchiveAuthentication::test_stats_requires_auth PASSED [ 51%]
test_log_archive.py::TestLogArchiveAuthentication::test_retention_config_requires_auth PASSED [ 52%]
test_log_archive.py::TestLogArchiveAuthentication::test_update_retention_requires_auth PASSED [ 52%]
test_log_archive.py::TestLogArchiveAuthentication::test_archive_requires_auth PASSED [ 52%]
test_log_archive.py::TestLogArchiveAuthentication::test_health_requires_auth PASSED [ 52%]
test_log_archive.py::TestLogStats::test_stats_returns_expected_fields PASSED [ 52%]
test_log_archive.py::TestLogStats::test_stats_log_files_structure PASSED [ 52%]
test_log_archive.py::TestRetentionConfig::test_get_retention_returns_defaults PASSED [ 53%]
test_log_archive.py::TestRetentionConfig::test_update_retention_validates_days_minimum PASSED [ 53%]
test_log_archive.py::TestRetentionConfig::test_update_retention_validates_days_maximum PASSED [ 53%]
test_log_archive.py::TestRetentionConfig::test_update_retention_validates_hour_range PASSED [ 53%]
test_log_archive.py::TestRetentionConfig::test_update_retention_succeeds PASSED [ 53%]
test_log_archive.py::TestArchiveService::test_extract_date_from_filename FAILED [ 54%]
test_log_archive.py::TestArchiveService::test_compression_reduces_size FAILED [ 54%]
test_log_archive.py::TestArchiveService::test_compression_integrity_check FAILED [ 54%]
test_log_archive.py::TestManualArchive::test_archive_endpoint_exists PASSED [ 54%]
test_log_archive.py::TestManualArchive::test_archive_returns_expected_fields PASSED [ 54%]
test_log_archive.py::TestManualArchive::test_archive_respects_retention_days_param PASSED [ 54%]
test_log_archive.py::TestLogServiceHealth::test_health_returns_scheduler_status PASSED [ 55%]
test_log_archive.py::TestLogArchiveIntegration::test_full_archive_workflow FAILED [ 55%]
test_log_archive.py::TestLogArchiveIntegration::test_retention_config_persists_runtime_changes PASSED [ 55%]
test_log_archive.py::TestArchiveValidation::test_archive_validates_retention_days_negative PASSED [ 55%]
test_log_archive.py::TestArchiveValidation::test_archive_validates_retention_days_excessive PASSED [ 55%]
test_log_archive.py::TestArchiveErrorHandling::test_archive_handles_missing_log_directory FAILED [ 56%]
test_log_archive.py::TestArchiveErrorHandling::test_checksum_calculation FAILED [ 56%]
test_mcp_keys.py::TestCreateApiKey::test_create_api_key <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_mcp_keys.py PASSED [ 56%]
test_mcp_keys.py::TestCreateApiKey::test_created_key_has_prefix <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_mcp_keys.py PASSED [ 56%]
test_mcp_keys.py::TestListApiKeys::test_list_api_keys <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_mcp_keys.py PASSED [ 56%]
test_mcp_keys.py::TestListApiKeys::test_listed_keys_dont_expose_full_key <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_mcp_keys.py PASSED [ 56%]
test_mcp_keys.py::TestValidateApiKey::test_validate_valid_key <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_mcp_keys.py PASSED [ 57%]
test_mcp_keys.py::TestValidateApiKey::test_validate_invalid_key <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_mcp_keys.py PASSED [ 57%]
test_mcp_keys.py::TestRevokeApiKey::test_revoke_api_key <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_mcp_keys.py PASSED [ 57%]
test_mcp_keys.py::TestDeleteApiKey::test_delete_api_key <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_mcp_keys.py PASSED [ 57%]
test_observability.py::TestObservabilityAuthentication::test_observability_status_requires_auth PASSED [ 57%]
test_observability.py::TestObservabilityAuthentication::test_observability_metrics_requires_auth PASSED [ 57%]
test_observability.py::TestObservabilityStatus::test_get_observability_status_returns_structure PASSED [ 58%]
test_observability.py::TestObservabilityStatus::test_observability_status_when_disabled PASSED [ 58%]
test_observability.py::TestObservabilityStatus::test_observability_status_when_enabled PASSED [ 58%]
test_observability.py::TestObservabilityMetrics::test_get_observability_metrics_returns_structure PASSED [ 58%]
test_observability.py::TestObservabilityMetrics::test_observability_metrics_when_disabled PASSED [ 58%]
test_observability.py::TestObservabilityMetrics::test_observability_metrics_structure_when_available PASSED [ 59%]
test_observability.py::TestObservabilityMetrics::test_observability_metrics_graceful_failure PASSED [ 59%]
test_observability.py::TestObservabilityMetricsData::test_cost_by_model_is_dict PASSED [ 59%]
test_observability.py::TestObservabilityMetricsData::test_tokens_by_model_structure PASSED [ 59%]
test_observability.py::TestObservabilityMetricsData::test_totals_are_numeric PASSED [ 59%]
test_ops.py::TestFleetStatusAuthentication::test_fleet_status_requires_auth PASSED [ 59%]
test_ops.py::TestFleetStatusAuthentication::test_fleet_health_requires_auth PASSED [ 60%]
test_ops.py::TestFleetStatusAuthentication::test_fleet_restart_requires_auth PASSED [ 60%]
test_ops.py::TestFleetStatusAuthentication::test_fleet_stop_requires_auth PASSED [ 60%]
test_ops.py::TestFleetStatusAuthentication::test_emergency_stop_requires_auth PASSED [ 60%]
test_ops.py::TestFleetStatus::test_get_fleet_status_returns_summary PASSED [ 60%]
test_ops.py::TestFleetStatus::test_fleet_status_agents_have_required_fields PASSED [ 61%]
test_ops.py::TestFleetStatus::test_fleet_status_summary_counts_match PASSED [ 61%]
test_ops.py::TestFleetHealth::test_get_fleet_health_returns_structure PASSED [ 61%]
test_ops.py::TestFleetHealth::test_fleet_health_healthy_count PASSED     [ 61%]
test_ops.py::TestSchedulesList::test_schedules_list_requires_auth PASSED [ 61%]
test_ops.py::TestSchedulesList::test_schedules_list_returns_structure PASSED [ 61%]
test_ops.py::TestSchedulesList::test_schedules_list_schedule_fields PASSED [ 62%]
test_ops.py::TestSchedulesList::test_schedules_list_with_agent_filter PASSED [ 62%]
test_ops.py::TestSchedulesList::test_schedules_list_nonexistent_agent_returns_empty PASSED [ 62%]
test_ops.py::TestSchedulesList::test_schedules_list_enabled_only_filter PASSED [ 62%]
test_ops.py::TestSchedulesList::test_schedules_list_summary_counts_match PASSED [ 62%]
test_ops.py::TestSchedulesList::test_schedules_list_includes_execution_info PASSED [ 63%]
test_ops.py::TestScheduleControl::test_schedules_pause_requires_auth PASSED [ 63%]
test_ops.py::TestScheduleControl::test_schedules_resume_requires_auth PASSED [ 63%]
test_ops.py::TestScheduleControl::test_pause_schedules_returns_count PASSED [ 63%]
test_ops.py::TestScheduleControl::test_resume_schedules_returns_count PASSED [ 63%]
test_ops.py::TestScheduleControl::test_pause_schedules_with_agent_filter PASSED [ 63%]
test_ops.py::TestAlerts::test_list_alerts_requires_auth PASSED           [ 64%]
test_ops.py::TestAlerts::test_list_alerts_returns_structure PASSED       [ 64%]
test_ops.py::TestAlerts::test_list_alerts_with_limit PASSED              [ 64%]
test_ops.py::TestAlerts::test_acknowledge_alert_requires_auth PASSED     [ 64%]
test_ops.py::TestOpsCosts::test_costs_requires_auth PASSED               [ 64%]
test_ops.py::TestOpsCosts::test_costs_returns_structure PASSED           [ 64%]
test_ops.py::TestOpsCosts::test_costs_disabled_response PASSED           [ 65%]
test_ops.py::TestContextStats::test_get_context_stats PASSED             [ 65%]
test_ops.py::TestContextStats::test_context_stats_structure PASSED       [ 65%]
test_ops.py::TestContextStats::test_context_stats_entries_have_valid_structure PASSED [ 65%]
test_ops.py::TestContextStats::test_context_stats_requires_auth PASSED   [ 65%]
test_ops.py::TestContextStats::test_context_stats_returns_valid_response PASSED [ 66%]
test_parallel_task.py::TestParallelTaskEndpoint::test_task_endpoint_exists PASSED [ 66%]
test_parallel_task.py::TestParallelTaskEndpoint::test_task_nonexistent_agent_returns_404 PASSED [ 66%]
test_parallel_task.py::TestParallelTaskEndpoint::test_task_stopped_agent_returns_error PASSED [ 66%]
test_public_links.py::TestPublicLinkDatabase::test_database_tables_exist SKIPPED [ 66%]
test_public_links.py::TestPublicEndpoints::test_get_invalid_link PASSED  [ 66%]
test_public_links.py::TestPublicEndpoints::test_verify_request_invalid_link PASSED [ 67%]
test_public_links.py::TestPublicEndpoints::test_verify_confirm_invalid_link PASSED [ 67%]
test_public_links.py::TestPublicEndpoints::test_public_chat_invalid_link PASSED [ 67%]
test_public_links.py::TestOwnerEndpointsNoAuth::test_list_links_requires_auth PASSED [ 67%]
test_public_links.py::TestOwnerEndpointsNoAuth::test_create_link_requires_auth PASSED [ 67%]
test_public_links.py::TestOwnerEndpointsWithAuth::test_list_links_agent_not_found SKIPPED [ 68%]
test_public_links.py::TestOwnerEndpointsWithAuth::test_create_link_agent_not_found SKIPPED [ 68%]
test_public_links.py::TestPublicLinkLifecycle::test_full_link_lifecycle SKIPPED [ 68%]
test_public_links.py::TestEmailVerification::test_link_requires_email SKIPPED [ 68%]
test_public_links.py::TestEmailVerification::test_verification_request_sent SKIPPED [ 68%]
test_public_links.py::TestEmailVerification::test_verification_rate_limiting SKIPPED [ 68%]
test_public_links.py::TestEmailVerification::test_invalid_verification_code SKIPPED [ 69%]
test_public_links.py::TestPublicChat::test_chat_without_email_requirement SKIPPED [ 69%]
test_schedules.py::TestSchedulerStatus::test_get_scheduler_status PASSED [ 69%]
test_schedules.py::TestSchedulerStatus::test_scheduler_status_structure PASSED [ 69%]
test_schedules.py::TestSchedulerStatus::test_scheduler_status_includes_jobs PASSED [ 69%]
test_schedules.py::TestSchedulerStatus::test_scheduler_status_requires_auth PASSED [ 70%]
test_schedules.py::TestCreateSchedule::test_create_schedule PASSED       [ 70%]
test_schedules.py::TestCreateSchedule::test_create_schedule_validates_cron PASSED [ 70%]
test_schedules.py::TestListSchedules::test_list_schedules PASSED         [ 70%]
test_schedules.py::TestListSchedules::test_schedule_has_required_fields PASSED [ 70%]
test_schedules.py::TestEnableDisableSchedule::test_enable_schedule PASSED [ 70%]
test_schedules.py::TestEnableDisableSchedule::test_disable_schedule PASSED [ 71%]
test_schedules.py::TestScheduleExecutions::test_get_execution_history PASSED [ 71%]
test_schedules.py::TestDeleteSchedule::test_delete_schedule PASSED       [ 71%]
test_settings.py::TestSettingsEndpointsAuthentication::test_list_settings_requires_auth PASSED [ 71%]
test_settings.py::TestSettingsEndpointsAuthentication::test_get_setting_requires_auth PASSED [ 71%]
test_settings.py::TestSettingsEndpointsAuthentication::test_update_setting_requires_auth PASSED [ 71%]
test_settings.py::TestSettingsEndpointsAuthentication::test_delete_setting_requires_auth PASSED [ 72%]
test_settings.py::TestSettingsEndpointsAdmin::test_list_settings_returns_array PASSED [ 72%]
test_settings.py::TestSettingsEndpointsAdmin::test_get_nonexistent_setting_returns_404 PASSED [ 72%]
test_settings.py::TestSettingsEndpointsAdmin::test_create_and_get_setting PASSED [ 72%]
test_settings.py::TestSettingsEndpointsAdmin::test_update_existing_setting PASSED [ 72%]
test_settings.py::TestSettingsEndpointsAdmin::test_delete_setting PASSED [ 73%]
test_settings.py::TestSettingsEndpointsAdmin::test_delete_nonexistent_setting_returns_success PASSED [ 73%]
test_settings.py::TestTrinityPromptSetting::test_trinity_prompt_crud PASSED [ 73%]
test_settings.py::TestTrinityPromptSetting::test_trinity_prompt_supports_markdown PASSED [ 73%]
test_settings.py::TestTrinityPromptSetting::test_trinity_prompt_appears_in_list PASSED [ 73%]
test_settings.py::TestSettingsValidation::test_empty_value_rejected PASSED [ 73%]
test_settings.py::TestSettingsValidation::test_missing_value_field_rejected PASSED [ 74%]
test_settings.py::TestSettingsValidation::test_invalid_json_rejected PASSED [ 74%]
test_settings.py::TestApiKeysAuthentication::test_get_api_keys_requires_auth PASSED [ 74%]
test_settings.py::TestApiKeysAuthentication::test_update_api_key_requires_auth PASSED [ 74%]
test_settings.py::TestApiKeysAuthentication::test_delete_api_key_requires_auth PASSED [ 74%]
test_settings.py::TestApiKeysAuthentication::test_test_api_key_requires_auth PASSED [ 75%]
test_settings.py::TestApiKeysStatus::test_get_api_keys_status_returns_structure PASSED [ 75%]
test_settings.py::TestApiKeysStatus::test_anthropic_key_status_fields PASSED [ 75%]
test_settings.py::TestApiKeyValidation::test_invalid_format_rejected PASSED [ 75%]
test_settings.py::TestApiKeyValidation::test_missing_api_key_field_rejected PASSED [ 75%]
test_settings.py::TestApiKeyValidation::test_empty_api_key_rejected PASSED [ 75%]
test_settings.py::TestApiKeyValidation::test_whitespace_only_api_key_rejected PASSED [ 76%]
test_settings.py::TestApiKeyTest::test_invalid_format_returns_invalid PASSED [ 76%]
test_settings.py::TestApiKeyTest::test_wrong_prefix_returns_invalid PASSED [ 76%]
test_settings.py::TestApiKeyTest::test_fake_valid_format_returns_response PASSED [ 76%]
test_settings.py::TestApiKeyDelete::test_delete_returns_success_structure PASSED [ 76%]
test_settings.py::TestApiKeyDelete::test_delete_idempotent PASSED        [ 77%]
test_settings.py::TestApiKeyDelete::test_delete_shows_env_fallback PASSED [ 77%]
test_settings.py::TestSshAccessAuthentication::test_ssh_access_requires_auth PASSED [ 77%]
test_settings.py::TestSshAccessEndpoint::test_ssh_access_nonexistent_agent_returns_404 FAILED [ 77%]
test_settings.py::TestSshAccessEndpoint::test_ssh_access_returns_key_credentials FAILED [ 77%]
test_settings.py::TestSshAccessEndpoint::test_ssh_access_returns_password_credentials FAILED [ 77%]
test_settings.py::TestSshAccessEndpoint::test_ssh_access_includes_expiry_time FAILED [ 78%]
test_settings.py::TestSshAccessEndpoint::test_ssh_access_respects_ttl_parameter FAILED [ 78%]
test_settings.py::TestSshAccessEndpoint::test_ssh_access_includes_instructions FAILED [ 78%]
test_settings.py::TestSshAccessStoppedAgent::test_ssh_access_stopped_agent_returns_400 FAILED [ 78%]
test_settings.py::TestGitHubPATTest::test_github_pat_test_requires_auth PASSED [ 78%]
test_settings.py::TestGitHubPATTest::test_github_pat_invalid_format_rejected PASSED [ 78%]
test_settings.py::TestGitHubPATTest::test_github_pat_valid_format_returns_response PASSED [ 79%]
test_settings.py::TestGitHubPATTest::test_github_pat_fine_grained_format_accepted PASSED [ 79%]
test_settings.py::TestOpsSettingsAuthentication::test_get_ops_config_requires_auth PASSED [ 79%]
test_settings.py::TestOpsSettingsAuthentication::test_update_ops_config_requires_auth PASSED [ 79%]
test_settings.py::TestOpsSettingsAuthentication::test_reset_ops_config_requires_auth PASSED [ 79%]
test_settings.py::TestOpsSettingsGet::test_get_ops_config_returns_structure PASSED [ 80%]
test_settings.py::TestOpsSettingsGet::test_ops_config_has_ssh_setting PASSED [ 80%]
test_settings.py::TestOpsSettingsGet::test_ops_config_shows_default_indicator PASSED [ 80%]
test_settings.py::TestOpsSettingsUpdate::test_update_ops_setting_persists PASSED [ 80%]
test_settings.py::TestOpsSettingsUpdate::test_update_ignores_invalid_keys PASSED [ 80%]
test_settings.py::TestOpsSettingsReset::test_reset_ops_settings_succeeds PASSED [ 80%]
test_settings.py::TestOpsSettingsReset::test_reset_restores_default_values PASSED [ 81%]
test_setup.py::TestSetupStatus::test_setup_status_accessible_without_auth PASSED [ 81%]
test_setup.py::TestSetupStatus::test_setup_status_returns_valid_response PASSED [ 81%]
test_setup.py::TestSetupStatus::test_setup_status_is_boolean PASSED      [ 81%]
test_setup.py::TestSetupAdminPassword::test_setup_blocked_after_completion PASSED [ 81%]
test_setup.py::TestSetupAdminPassword::test_password_validation_short_password SKIPPED [ 82%]
test_setup.py::TestSetupAdminPassword::test_password_validation_mismatch SKIPPED [ 82%]
test_setup.py::TestSetupAdminPassword::test_password_validation_missing_fields SKIPPED [ 82%]
test_setup.py::TestAuthModeSetupStatus::test_auth_mode_includes_setup_status PASSED [ 82%]
test_setup.py::TestAuthModeSetupStatus::test_auth_mode_setup_status_matches_setup_endpoint PASSED [ 82%]
test_setup.py::TestLoginBlockedBeforeSetup::test_login_returns_setup_required_before_setup SKIPPED [ 82%]
test_shared_folders.py::TestSharedFoldersAuthentication::test_get_folders_requires_auth PASSED [ 83%]
test_shared_folders.py::TestSharedFoldersAuthentication::test_update_folders_requires_auth PASSED [ 83%]
test_shared_folders.py::TestSharedFoldersAuthentication::test_available_folders_requires_auth PASSED [ 83%]
test_shared_folders.py::TestSharedFoldersAuthentication::test_folder_consumers_requires_auth PASSED [ 83%]
test_shared_folders.py::TestGetFoldersConfig::test_get_folders_returns_structure PASSED [ 83%]
test_shared_folders.py::TestGetFoldersConfig::test_folders_boolean_fields PASSED [ 84%]
test_shared_folders.py::TestGetFoldersConfig::test_folders_default_values PASSED [ 84%]
test_shared_folders.py::TestGetFoldersConfig::test_folders_includes_status PASSED [ 84%]
test_shared_folders.py::TestGetFoldersConfig::test_nonexistent_agent_returns_404 PASSED [ 84%]
test_shared_folders.py::TestUpdateFoldersConfig::test_enable_expose PASSED [ 84%]
test_shared_folders.py::TestUpdateFoldersConfig::test_enable_consume PASSED [ 84%]
test_shared_folders.py::TestUpdateFoldersConfig::test_update_returns_restart_required PASSED [ 85%]
test_shared_folders.py::TestUpdateFoldersConfig::test_update_persists PASSED [ 85%]
test_shared_folders.py::TestUpdateFoldersConfig::test_disable_after_enable PASSED [ 85%]
test_shared_folders.py::TestUpdateFoldersConfig::test_partial_update PASSED [ 85%]
test_shared_folders.py::TestAvailableFolders::test_available_folders_returns_structure PASSED [ 85%]
test_shared_folders.py::TestAvailableFolders::test_available_folders_is_list PASSED [ 85%]
test_shared_folders.py::TestAvailableFolders::test_available_folder_structure PASSED [ 86%]
test_shared_folders.py::TestFolderConsumers::test_consumers_returns_structure PASSED [ 86%]
test_shared_folders.py::TestFolderConsumers::test_consumers_is_list PASSED [ 86%]
test_shared_folders.py::TestSharedFoldersOwnershipRequired::test_update_requires_ownership PASSED [ 86%]
test_system_agent.py::TestSystemAgentAuthentication::test_system_agent_status_requires_auth PASSED [ 86%]
test_system_agent.py::TestSystemAgentAuthentication::test_system_agent_restart_requires_auth PASSED [ 87%]
test_system_agent.py::TestSystemAgentAuthentication::test_system_agent_reinitialize_requires_auth PASSED [ 87%]
test_system_agent.py::TestSystemAgentStatus::test_get_system_agent_status_returns_structure PASSED [ 87%]
test_system_agent.py::TestSystemAgentStatus::test_system_agent_status_running_has_container_id PASSED [ 87%]
test_system_agent.py::TestSystemAgentStatus::test_system_agent_status_includes_is_system_flag PASSED [ 87%]
test_system_agent.py::TestSystemAgentStatus::test_system_agent_status_not_found_response PASSED [ 87%]
test_system_agent.py::TestSystemAgentRestart::test_restart_not_found_returns_404 PASSED [ 88%]
test_system_agent.py::TestSystemAgentReinitialize::test_reinitialize_not_found_returns_404 PASSED [ 88%]
test_system_agent.py::TestSystemAgentHealthInfo::test_system_agent_health_endpoint PASSED [ 88%]
test_system_agent.py::TestSystemAgentHealthInfo::test_system_agent_health_error_handled PASSED [ 88%]
test_systems.py::TestSystemManifestParsing::test_dry_run_minimal_manifest PASSED [ 88%]
test_systems.py::TestSystemManifestParsing::test_dry_run_invalid_yaml PASSED [ 89%]
test_systems.py::TestSystemManifestParsing::test_dry_run_missing_name PASSED [ 89%]
test_systems.py::TestSystemManifestParsing::test_dry_run_missing_agents PASSED [ 89%]
test_systems.py::TestSystemManifestParsing::test_dry_run_invalid_system_name PASSED [ 89%]
test_systems.py::TestSystemManifestParsing::test_dry_run_invalid_template_prefix PASSED [ 89%]
test_systems.py::TestSystemManifestParsing::test_dry_run_invalid_permission_preset PASSED [ 89%]
test_systems.py::TestSystemManifestParsing::test_dry_run_both_preset_and_explicit PASSED [ 90%]
test_systems.py::TestSystemDeployment::test_deploy_minimal_system PASSED [ 90%]
test_systems.py::TestSystemDeployment::test_deploy_conflict_resolution PASSED [ 90%]
test_systems.py::TestSystemDeployment::test_deploy_updates_trinity_prompt PASSED [ 90%]
test_systems.py::TestSystemPermissions::test_full_mesh_permissions PASSED [ 90%]
test_systems.py::TestSystemPermissions::test_orchestrator_workers_permissions PASSED [ 91%]
test_systems.py::TestSystemPermissions::test_explicit_permissions PASSED [ 91%]
test_systems.py::TestSystemPermissions::test_none_permissions_preset PASSED [ 91%]
test_systems.py::TestSystemFolders::test_shared_folders_configuration PASSED [ 91%]
test_systems.py::TestSystemSchedules::test_schedules_created PASSED      [ 91%]
test_systems.py::TestSystemAutoStart::test_agents_started_after_deployment PASSED [ 91%]
test_systems.py::TestSystemBackendEndpoints::test_list_systems_endpoint PASSED [ 92%]
test_systems.py::TestSystemBackendEndpoints::test_get_system_endpoint PASSED [ 92%]
test_systems.py::TestSystemBackendEndpoints::test_get_nonexistent_system_returns_404 PASSED [ 92%]
test_systems.py::TestSystemBackendEndpoints::test_restart_system_endpoint PASSED [ 92%]
test_systems.py::TestSystemBackendEndpoints::test_export_manifest_endpoint PASSED [ 92%]
test_systems.py::TestSystemEdgeCases::test_deploy_requires_authentication PASSED [ 92%]
test_systems.py::TestSystemEdgeCases::test_deploy_empty_manifest PASSED  [ 93%]
test_systems.py::TestSystemEdgeCases::test_deploy_with_unknown_agent_in_permissions PASSED [ 93%]
test_systems.py::TestSystemEdgeCases::test_list_systems_requires_auth PASSED [ 93%]
test_systems.py::TestSystemEdgeCases::test_restart_nonexistent_system PASSED [ 93%]
test_telemetry.py::TestHostTelemetry::test_host_returns_cpu_metrics PASSED [ 93%]
test_telemetry.py::TestHostTelemetry::test_host_returns_memory_metrics PASSED [ 94%]
test_telemetry.py::TestHostTelemetry::test_host_returns_disk_metrics PASSED [ 94%]
test_telemetry.py::TestHostTelemetry::test_host_returns_timestamp PASSED [ 94%]
test_telemetry.py::TestHostTelemetry::test_host_no_auth_required PASSED  [ 94%]
test_telemetry.py::TestHostTelemetry::test_host_cpu_count_present PASSED [ 94%]
test_telemetry.py::TestContainerTelemetry::test_containers_returns_running_count PASSED [ 94%]
test_telemetry.py::TestContainerTelemetry::test_containers_returns_total_cpu_percent PASSED [ 95%]
test_telemetry.py::TestContainerTelemetry::test_containers_returns_total_memory_mb PASSED [ 95%]
test_telemetry.py::TestContainerTelemetry::test_containers_includes_container_list PASSED [ 95%]
test_telemetry.py::TestContainerTelemetry::test_containers_container_has_metrics PASSED [ 95%]
test_telemetry.py::TestContainerTelemetry::test_containers_includes_test_agent PASSED [ 95%]
test_telemetry.py::TestContainerTelemetry::test_containers_returns_timestamp PASSED [ 96%]
test_telemetry.py::TestContainerTelemetry::test_containers_no_auth_required PASSED [ 96%]
test_telemetry.py::TestTelemetryConsistency::test_container_count_matches_list_length PASSED [ 96%]
test_telemetry.py::TestTelemetryConsistency::test_total_memory_is_sum_of_containers PASSED [ 96%]
test_templates.py::TestListTemplates::test_list_templates <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_templates.py PASSED [ 96%]
test_templates.py::TestListTemplates::test_template_has_required_fields <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_templates.py PASSED [ 96%]
test_templates.py::TestListTemplates::test_templates_include_required_credentials <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_templates.py PASSED [ 97%]
test_templates.py::TestGetTemplateDetails::test_get_template_by_id <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_templates.py PASSED [ 97%]
test_templates.py::TestGetTemplateDetails::test_get_nonexistent_template_returns_404 <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_templates.py PASSED [ 97%]
test_templates.py::TestEnvTemplate::test_get_env_template <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_templates.py PASSED [ 97%]
test_templates.py::TestEnvTemplate::test_env_template_with_template_id <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_templates.py PASSED [ 97%]
test_templates.py::TestTemplateRefresh::test_refresh_templates <- ../../../Coding/N8N_Main_repos/project_trinity/tests/test_templates.py SKIPPED [ 98%]
test_web_terminal.py::TestSystemAgentTerminalAuthentication::test_terminal_endpoint_exists PASSED [ 98%]
test_web_terminal.py::TestSystemAgentTerminalAuthentication::test_system_agent_status_accessible PASSED [ 98%]
test_web_terminal.py::TestSystemAgentTerminalAccess::test_system_agent_must_exist SKIPPED [ 98%]
test_web_terminal.py::TestSystemAgentTerminalAccess::test_system_agent_must_be_running SKIPPED [ 98%]
test_web_terminal.py::TestSystemAgentTerminalModes::test_terminal_supports_claude_mode PASSED [ 98%]
test_web_terminal.py::TestSystemAgentTerminalModes::test_terminal_supports_bash_mode PASSED [ 99%]
test_web_terminal.py::TestSystemAgentTerminalPrerequisites::test_status_includes_container_id SKIPPED [ 99%]
test_web_terminal.py::TestSystemAgentTerminalPrerequisites::test_status_includes_is_system_flag SKIPPED [ 99%]
test_web_terminal.py::TestAgentTerminalAuthentication::test_agent_terminal_requires_auth PASSED [ 99%]
test_web_terminal.py::TestAgentTerminalAuthentication::test_agent_terminal_requires_running_agent PASSED [ 99%]
test_web_terminal.py::TestTerminalAuditLogging::test_system_agent_restart_logged SKIPPED [100%]

=================================== FAILURES ===================================
_______ TestApiKeySettingCRUD.test_get_api_key_setting_returns_structure _______
test_agent_api_key_setting.py:57: in test_get_api_key_setting_returns_structure
    assert_status(response, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 404. 
E   Response body: {"detail":"Agent not found"}
________ TestApiKeySettingCRUD.test_get_api_key_setting_default_is_true ________
test_agent_api_key_setting.py:67: in test_get_api_key_setting_default_is_true
    assert_status(response, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 404. 
E   Response body: {"detail":"Agent not found"}
______ TestApiKeySettingCRUD.test_put_api_key_setting_update_and_restore _______
test_agent_api_key_setting.py:81: in test_put_api_key_setting_update_and_restore
    assert_status(current, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 404. 
E   Response body: {"detail":"Agent not found"}
__ TestApiKeySettingCRUD.test_put_api_key_setting_missing_field_returns_error __
test_agent_api_key_setting.py:123: in test_put_api_key_setting_missing_field_returns_error
    assert_status_in(response, [400, 422, 500])
utils/assertions.py:25: in assert_status_in
    raise AssertionError(
E   AssertionError: Expected status in [400, 422, 500], got 404. 
E   Response body: {"detail":"Agent not found"}
__ TestApiKeySettingValidation.test_put_api_key_setting_string_value_handled ___
test_agent_api_key_setting.py:141: in test_put_api_key_setting_string_value_handled
    assert_status_in(response, [200, 400, 422])
utils/assertions.py:25: in assert_status_in
    raise AssertionError(
E   AssertionError: Expected status in [200, 400, 422], got 404. 
E   Response body: {"detail":"Agent not found"}
_______ TestApiKeySettingPermissions.test_admin_can_read_api_key_setting _______
test_agent_api_key_setting.py:165: in test_admin_can_read_api_key_setting
    assert_status(response, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 404. 
E   Response body: {"detail":"Agent not found"}
______ TestApiKeySettingPermissions.test_admin_can_update_api_key_setting ______
test_agent_api_key_setting.py:171: in test_admin_can_update_api_key_setting
    original_value = current["use_platform_api_key"]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'use_platform_api_key'
__ TestApiKeySettingAgentState.test_api_key_setting_update_response_structure __
test_agent_api_key_setting.py:214: in test_api_key_setting_update_response_structure
    original_value = current["use_platform_api_key"]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'use_platform_api_key'
____ TestApiKeySettingIntegration.test_api_key_setting_get_put_consistency _____
test_agent_api_key_setting.py:252: in test_api_key_setting_get_put_consistency
    assert_status(get_response, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 404. 
E   Response body: {"detail":"Agent not found"}
_______ TestApiKeySettingResponseFormat.test_get_response_has_agent_name _______
test_agent_api_key_setting.py:278: in test_get_response_has_agent_name
    assert_status(response, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 404. 
E   Response body: {"detail":"Agent not found"}
_____ TestApiKeySettingResponseFormat.test_put_response_has_updated_value ______
test_agent_api_key_setting.py:287: in test_put_response_has_updated_value
    original_value = current["use_platform_api_key"]
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'use_platform_api_key'
_______________ TestUpdateFile.test_update_file_changes_content ________________
test_agent_files.py:316: in test_update_file_changes_content
    assert_status_in(response, [200, 201])
utils/assertions.py:25: in assert_status_in
    raise AssertionError(
E   AssertionError: Expected status in [200, 201], got 404. 
E   Response body: {"detail":"File not found: /home/developer/test_update_file.txt"}
____________ TestUpdateFile.test_update_creates_file_if_not_exists _____________
test_agent_files.py:354: in test_update_creates_file_if_not_exists
    assert_status_in(response, [200, 201])
utils/assertions.py:25: in assert_status_in
    raise AssertionError(
E   AssertionError: Expected status in [200, 201], got 404. 
E   Response body: {"detail":"File not found: /home/developer/new_file_f8e4018b.txt"}
______________ TestGitInitialize.test_git_init_returns_structure _______________
test_agent_git.py:220: in test_git_init_returns_structure
    assert_status_in(response, [200, 400, 409])
utils/assertions.py:25: in assert_status_in
    raise AssertionError(
E   AssertionError: Expected status in [200, 400, 409], got 500. 
E   Response body: {"detail":"Git initialization failed: Git command failed: git push -u origin main --force\nOutput: remote: Repository not found.\nfatal: repository 'https://github.com/test-user/test-test-agent-git-5ac01c.git/' not found\n"}
_ TestExecutionStreamingEndpoint.test_stream_nonexistent_execution_returns_404 _
test_execution_streaming.py:58: in test_stream_nonexistent_execution_returns_404
    assert_status_in(response, [400, 404])
utils/assertions.py:25: in assert_status_in
    raise AssertionError(
E   AssertionError: Expected status in [400, 404], got 200. 
E   Response body: data: {"type": "error", "message": "Execution not found"}
E   
E   data: {"type": "stream_end"}
__________ TestExecutionStreamingEndpoint.test_stream_endpoint_exists __________
test_execution_streaming.py:85: in test_stream_endpoint_exists
    assert_status_in(response, [400, 404, 503])
utils/assertions.py:25: in assert_status_in
    raise AssertionError(
E   AssertionError: Expected status in [400, 404, 503], got 200. 
E   Response body: data: {"type": "error", "message": "Execution not found"}
E   
E   data: {"type": "stream_end"}
_____ TestExecutionStreamingErrors.test_stream_invalid_execution_id_format _____
test_execution_streaming.py:207: in test_stream_invalid_execution_id_format
    assert_status_in(response, [400, 404, 422])
utils/assertions.py:25: in assert_status_in
    raise AssertionError(
E   AssertionError: Expected status in [400, 404, 422], got 200. 
E   Response body: data: {"type": "error", "message": "Execution not found"}
E   
E   data: {"type": "stream_end"}
______________ TestArchiveService.test_extract_date_from_filename ______________
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   FileNotFoundError: [Errno 2] No such file or directory: '/data/archives'

During handling of the above exception, another exception occurred:
test_log_archive.py:229: in test_extract_date_from_filename
    from services.log_archive_service import LogArchiveService
../src/backend/services/log_archive_service.py:290: in <module>
    log_archive_service = LogArchiveService()
                          ^^^^^^^^^^^^^^^^^^^
../src/backend/services/log_archive_service.py:37: in __init__
    self.storage = get_archive_storage()
                   ^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:220: in get_archive_storage
    return LocalArchiveStorage(archive_path=archive_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:83: in __init__
    self.archive_path.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1020: in mkdir
    self.parent.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   OSError: [Errno 30] Read-only file system: '/data'
----------------------------- Captured stdout call -----------------------------
WARNING: SECRET_KEY not set - generated random key for this session
         For production, set SECRET_KEY environment variable
_______________ TestArchiveService.test_compression_reduces_size _______________
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   FileNotFoundError: [Errno 2] No such file or directory: '/data/archives'

During handling of the above exception, another exception occurred:
test_log_archive.py:245: in test_compression_reduces_size
    from services.log_archive_service import LogArchiveService
../src/backend/services/log_archive_service.py:290: in <module>
    log_archive_service = LogArchiveService()
                          ^^^^^^^^^^^^^^^^^^^
../src/backend/services/log_archive_service.py:37: in __init__
    self.storage = get_archive_storage()
                   ^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:220: in get_archive_storage
    return LocalArchiveStorage(archive_path=archive_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:83: in __init__
    self.archive_path.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1020: in mkdir
    self.parent.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   OSError: [Errno 30] Read-only file system: '/data'
_____________ TestArchiveService.test_compression_integrity_check ______________
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   FileNotFoundError: [Errno 2] No such file or directory: '/data/archives'

During handling of the above exception, another exception occurred:
test_log_archive.py:275: in test_compression_integrity_check
    from services.log_archive_service import LogArchiveService
../src/backend/services/log_archive_service.py:290: in <module>
    log_archive_service = LogArchiveService()
                          ^^^^^^^^^^^^^^^^^^^
../src/backend/services/log_archive_service.py:37: in __init__
    self.storage = get_archive_storage()
                   ^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:220: in get_archive_storage
    return LocalArchiveStorage(archive_path=archive_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:83: in __init__
    self.archive_path.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1020: in mkdir
    self.parent.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   OSError: [Errno 30] Read-only file system: '/data'
_____________ TestLogArchiveIntegration.test_full_archive_workflow _____________
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   FileNotFoundError: [Errno 2] No such file or directory: '/data/archives'

During handling of the above exception, another exception occurred:
test_log_archive.py:377: in test_full_archive_workflow
    from services.log_archive_service import LogArchiveService
../src/backend/services/log_archive_service.py:290: in <module>
    log_archive_service = LogArchiveService()
                          ^^^^^^^^^^^^^^^^^^^
../src/backend/services/log_archive_service.py:37: in __init__
    self.storage = get_archive_storage()
                   ^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:220: in get_archive_storage
    return LocalArchiveStorage(archive_path=archive_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:83: in __init__
    self.archive_path.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1020: in mkdir
    self.parent.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   OSError: [Errno 30] Read-only file system: '/data'
_____ TestArchiveErrorHandling.test_archive_handles_missing_log_directory ______
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   FileNotFoundError: [Errno 2] No such file or directory: '/data/archives'

During handling of the above exception, another exception occurred:
test_log_archive.py:478: in test_archive_handles_missing_log_directory
    from services.log_archive_service import LogArchiveService
../src/backend/services/log_archive_service.py:290: in <module>
    log_archive_service = LogArchiveService()
                          ^^^^^^^^^^^^^^^^^^^
../src/backend/services/log_archive_service.py:37: in __init__
    self.storage = get_archive_storage()
                   ^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:220: in get_archive_storage
    return LocalArchiveStorage(archive_path=archive_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:83: in __init__
    self.archive_path.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1020: in mkdir
    self.parent.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   OSError: [Errno 30] Read-only file system: '/data'
______________ TestArchiveErrorHandling.test_checksum_calculation ______________
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   FileNotFoundError: [Errno 2] No such file or directory: '/data/archives'

During handling of the above exception, another exception occurred:
test_log_archive.py:490: in test_checksum_calculation
    from services.log_archive_service import LogArchiveService
../src/backend/services/log_archive_service.py:290: in <module>
    log_archive_service = LogArchiveService()
                          ^^^^^^^^^^^^^^^^^^^
../src/backend/services/log_archive_service.py:37: in __init__
    self.storage = get_archive_storage()
                   ^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:220: in get_archive_storage
    return LocalArchiveStorage(archive_path=archive_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../src/backend/services/archive_storage.py:83: in __init__
    self.archive_path.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1020: in mkdir
    self.parent.mkdir(parents=True, exist_ok=True)
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/pathlib/__init__.py:1016: in mkdir
    os.mkdir(self, mode)
E   OSError: [Errno 30] Read-only file system: '/data'
_____ TestSshAccessEndpoint.test_ssh_access_nonexistent_agent_returns_404 ______
test_settings.py:677: in test_ssh_access_nonexistent_agent_returns_404
    assert_status(response, 404)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 404, got 403. 
E   Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
________ TestSshAccessEndpoint.test_ssh_access_returns_key_credentials _________
test_settings.py:699: in test_ssh_access_returns_key_credentials
    assert_status(response, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 403. 
E   Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
______ TestSshAccessEndpoint.test_ssh_access_returns_password_credentials ______
test_settings.py:733: in test_ssh_access_returns_password_credentials
    assert_status(response, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 403. 
E   Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
__________ TestSshAccessEndpoint.test_ssh_access_includes_expiry_time __________
test_settings.py:762: in test_ssh_access_includes_expiry_time
    assert_status(response, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 403. 
E   Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
_________ TestSshAccessEndpoint.test_ssh_access_respects_ttl_parameter _________
test_settings.py:788: in test_ssh_access_respects_ttl_parameter
    assert_status(response, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 403. 
E   Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
_________ TestSshAccessEndpoint.test_ssh_access_includes_instructions __________
test_settings.py:811: in test_ssh_access_includes_instructions
    assert_status(response, 200)
utils/assertions.py:14: in assert_status
    raise AssertionError(
E   AssertionError: Expected status 200, got 403. 
E   Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
_____ TestSshAccessStoppedAgent.test_ssh_access_stopped_agent_returns_400 ______
test_settings.py:835: in test_ssh_access_stopped_agent_returns_400
    assert_status_in(response, [400, 503])
utils/assertions.py:25: in assert_status_in
    raise AssertionError(
E   AssertionError: Expected status in [400, 503], got 403. 
E   Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
=============================== warnings summary ===============================
test_log_archive.py::TestArchiveService::test_extract_date_from_filename
  /Users/eugene/Dropbox/trinity/trinity/src/backend/models.py:34: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class AgentStatus(BaseModel):

test_log_archive.py::TestArchiveService::test_extract_date_from_filename
test_log_archive.py::TestArchiveService::test_extract_date_from_filename
test_log_archive.py::TestArchiveService::test_extract_date_from_filename
  /Users/eugene/Dropbox/trinity/trinity/tests/.venv/lib/python3.14/site-packages/pydantic/_internal/_generate_schema.py:319: PydanticDeprecatedSince20: `json_encoders` is deprecated. See https://docs.pydantic.dev/2.12/concepts/serialization/#custom-serializers for alternatives. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    warnings.warn(

test_log_archive.py::TestArchiveService::test_extract_date_from_filename
  /Users/eugene/Dropbox/trinity/trinity/src/backend/models.py:165: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class Activity(BaseModel):

test_log_archive.py::TestArchiveService::test_extract_date_from_filename
  /Users/eugene/Dropbox/trinity/trinity/src/backend/models.py:207: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class Execution(BaseModel):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED test_agent_api_key_setting.py::TestApiKeySettingCRUD::test_get_api_key_setting_returns_structure - AssertionError: Expected status 200, got 404. 
Response body: {"detail":"Agent not found"}
FAILED test_agent_api_key_setting.py::TestApiKeySettingCRUD::test_get_api_key_setting_default_is_true - AssertionError: Expected status 200, got 404. 
Response body: {"detail":"Agent not found"}
FAILED test_agent_api_key_setting.py::TestApiKeySettingCRUD::test_put_api_key_setting_update_and_restore - AssertionError: Expected status 200, got 404. 
Response body: {"detail":"Agent not found"}
FAILED test_agent_api_key_setting.py::TestApiKeySettingCRUD::test_put_api_key_setting_missing_field_returns_error - AssertionError: Expected status in [400, 422, 500], got 404. 
Response body: {"detail":"Agent not found"}
FAILED test_agent_api_key_setting.py::TestApiKeySettingValidation::test_put_api_key_setting_string_value_handled - AssertionError: Expected status in [200, 400, 422], got 404. 
Response body: {"detail":"Agent not found"}
FAILED test_agent_api_key_setting.py::TestApiKeySettingPermissions::test_admin_can_read_api_key_setting - AssertionError: Expected status 200, got 404. 
Response body: {"detail":"Agent not found"}
FAILED test_agent_api_key_setting.py::TestApiKeySettingPermissions::test_admin_can_update_api_key_setting - KeyError: 'use_platform_api_key'
FAILED test_agent_api_key_setting.py::TestApiKeySettingAgentState::test_api_key_setting_update_response_structure - KeyError: 'use_platform_api_key'
FAILED test_agent_api_key_setting.py::TestApiKeySettingIntegration::test_api_key_setting_get_put_consistency - AssertionError: Expected status 200, got 404. 
Response body: {"detail":"Agent not found"}
FAILED test_agent_api_key_setting.py::TestApiKeySettingResponseFormat::test_get_response_has_agent_name - AssertionError: Expected status 200, got 404. 
Response body: {"detail":"Agent not found"}
FAILED test_agent_api_key_setting.py::TestApiKeySettingResponseFormat::test_put_response_has_updated_value - KeyError: 'use_platform_api_key'
FAILED test_agent_files.py::TestUpdateFile::test_update_file_changes_content - AssertionError: Expected status in [200, 201], got 404. 
Response body: {"detail":"File not found: /home/developer/test_update_file.txt"}
FAILED test_agent_files.py::TestUpdateFile::test_update_creates_file_if_not_exists - AssertionError: Expected status in [200, 201], got 404. 
Response body: {"detail":"File not found: /home/developer/new_file_f8e4018b.txt"}
FAILED test_agent_git.py::TestGitInitialize::test_git_init_returns_structure - AssertionError: Expected status in [200, 400, 409], got 500. 
Response body: {"detail":"Git initialization failed: Git command failed: git push -u origin main --force\nOutput: remote: Repository not found.\nfatal: repository 'https://github.com/test-user/test-test-agent-git-5ac01c.git/' not found\n"}
FAILED test_execution_streaming.py::TestExecutionStreamingEndpoint::test_stream_nonexistent_execution_returns_404 - AssertionError: Expected status in [400, 404], got 200. 
Response body: data: {"type": "error", "message": "Execution not found"}

data: {"type": "stream_end"}
FAILED test_execution_streaming.py::TestExecutionStreamingEndpoint::test_stream_endpoint_exists - AssertionError: Expected status in [400, 404, 503], got 200. 
Response body: data: {"type": "error", "message": "Execution not found"}

data: {"type": "stream_end"}
FAILED test_execution_streaming.py::TestExecutionStreamingErrors::test_stream_invalid_execution_id_format - AssertionError: Expected status in [400, 404, 422], got 200. 
Response body: data: {"type": "error", "message": "Execution not found"}

data: {"type": "stream_end"}
FAILED test_log_archive.py::TestArchiveService::test_extract_date_from_filename - OSError: [Errno 30] Read-only file system: '/data'
FAILED test_log_archive.py::TestArchiveService::test_compression_reduces_size - OSError: [Errno 30] Read-only file system: '/data'
FAILED test_log_archive.py::TestArchiveService::test_compression_integrity_check - OSError: [Errno 30] Read-only file system: '/data'
FAILED test_log_archive.py::TestLogArchiveIntegration::test_full_archive_workflow - OSError: [Errno 30] Read-only file system: '/data'
FAILED test_log_archive.py::TestArchiveErrorHandling::test_archive_handles_missing_log_directory - OSError: [Errno 30] Read-only file system: '/data'
FAILED test_log_archive.py::TestArchiveErrorHandling::test_checksum_calculation - OSError: [Errno 30] Read-only file system: '/data'
FAILED test_settings.py::TestSshAccessEndpoint::test_ssh_access_nonexistent_agent_returns_404 - AssertionError: Expected status 404, got 403. 
Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
FAILED test_settings.py::TestSshAccessEndpoint::test_ssh_access_returns_key_credentials - AssertionError: Expected status 200, got 403. 
Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
FAILED test_settings.py::TestSshAccessEndpoint::test_ssh_access_returns_password_credentials - AssertionError: Expected status 200, got 403. 
Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
FAILED test_settings.py::TestSshAccessEndpoint::test_ssh_access_includes_expiry_time - AssertionError: Expected status 200, got 403. 
Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
FAILED test_settings.py::TestSshAccessEndpoint::test_ssh_access_respects_ttl_parameter - AssertionError: Expected status 200, got 403. 
Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
FAILED test_settings.py::TestSshAccessEndpoint::test_ssh_access_includes_instructions - AssertionError: Expected status 200, got 403. 
Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
FAILED test_settings.py::TestSshAccessStoppedAgent::test_ssh_access_stopped_agent_returns_400 - AssertionError: Expected status in [400, 503], got 403. 
Response body: {"detail":"SSH access is disabled. Enable it in Settings  Ops Settings  ssh_access_enabled"}
= 30 failed, 480 passed, 47 skipped, 69 deselected, 6 warnings in 1135.23s (0:18:55) =
